

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>DoWhy | 让因果推断容易 &mdash; DoWhy | Making Causal Inference Easy  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="&lt;no title&gt;" href="example_notebooks/nb_index.html" />
    <link rel="prev" title="DoWhy | 让因果推断容易" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> DoWhy | Making Causal Inference Easy
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">DoWhy | 让因果推断容易</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id1">编译申明</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-need-for-causal-inference">The need for causal inference</a></li>
<li class="toctree-l2"><a class="reference internal" href="#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id3">使用 DoWhy 进行因果推断的一个简单例子</a></li>
<li class="toctree-l2"><a class="reference internal" href="#a-high-level-pandas-api">A High-level Pandas API</a></li>
<li class="toctree-l2"><a class="reference internal" href="#graphical-models-and-potential-outcomes-best-of-both-worlds">Graphical Models and Potential Outcomes: Best of both worlds</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id4">因果推理的统一语言</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id5">因果推断的四个步骤</a></li>
<li class="toctree-l2"><a class="reference internal" href="#citing-this-package">Citing this package</a></li>
<li class="toctree-l2"><a class="reference internal" href="#roadmap">Roadmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="#contributing">Contributing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="example_notebooks/dowhy_simple_example.html">DoWhy:一个简单例子</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_notebooks/dowhy_confounder_example.html">相关性还是因果效应？</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_notebooks/dowhy_estimation_methods.html">DoWhy: 因果效应估计方法</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_notebooks/dowhy-conditional-treatment-effects.html">用 DoWhy 和 EconML 估计条件平均因果效应</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_notebooks/dowhy_causal_api.html">DoWhy 因果 API Demo</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_notebooks/do_sampler_demo.html">Do-sampler 简介</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_notebooks/load_graph_example.html">Different ways to load an input graph</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_notebooks/dowhy-simple-iv-example.html">工具变量法估计因果效应</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_notebooks/dowhy_ihdp_data_example.html">IHDP 因果效应估计</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_notebooks/dowhy_lalonde_example.html">Lalonde 数据集上因果推断</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_notebooks/lalonde_pandas_api.html">Lalonde Pandas API Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="code_repo.html">Code repository &amp; Versions</a></li>
<li class="toctree-l1"><a class="reference internal" href="dowhy.html">dowhy package</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">DoWhy | Making Causal Inference Easy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>DoWhy | 让因果推断容易</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/readme.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<p><a class="reference external" href="https://dev.azure.com/ms/dowhy/_build/latest?definitionId=179&amp;branchName=master"><img alt="BuildStatus" src="https://dev.azure.com/ms/dowhy/_apis/build/status/microsoft.dowhy?branchName=master" /></a> <a class="reference external" href="https://pypi.org/project/dowhy/"><img alt="PyPiVersion" src="https://img.shields.io/pypi/v/dowhy.svg" /></a> <a class="reference external" href="https://pypi.org/project/dowhy/"><img alt="PythonSupport" src="https://img.shields.io/pypi/pyversions/dowhy.svg" /></a></p>
<div class="section" id="dowhy">
<h1><a class="toc-backref" href="#id8">DoWhy | 让因果推断容易</a><a class="headerlink" href="#dowhy" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="http://www.amitsharma.in">Amit Sharma</a>,
<a class="reference external" href="http://www.kiciman.org">Emre Kiciman</a>,
<a class="reference external" href="https://sites.google.com/view/minituring/">Heyang Gong 编译和解读</a></p>
<p>随着计算系统越来越频繁地，更加积极地介入社会关键领域，例如医疗保健，教育和治理，正确预测和理解这些干预措施的因果效应至关重要。 Without an A/B test, 常规机器学习方法 built on pattern recognition and correlational analyses 不足以进行因果推理。</p>
<p><strong>“DoWhy” is a Python library that aims to spark causal thinking and analysis</strong>. DoWhy为因果推断方法提供了统一的界面，并自动测试了许多假设，从而使非专家可以进行因果推断。 快速介绍因果推理见 <a class="reference external" href="http://causalinference.gitlab.io/kdd-tutorial/">causalinference.gitlab.io/kdd-tutorial</a>. Documentation for DoWhy is available at <a class="reference external" href="https://microsoft.github.io/dowhy/">microsoft.github.io/dowhy</a>.</p>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#dowhy" id="id8">DoWhy | 让因果推断容易</a></p>
<ul>
<li><p><a class="reference internal" href="#id1" id="id9">编译申明</a></p></li>
<li><p><a class="reference internal" href="#the-need-for-causal-inference" id="id10">The need for causal inference</a></p></li>
<li><p><a class="reference internal" href="#installation" id="id11">Installation</a></p></li>
<li><p><a class="reference internal" href="#id3" id="id12">使用 DoWhy 进行因果推断的一个简单例子</a></p></li>
<li><p><a class="reference internal" href="#a-high-level-pandas-api" id="id13">A High-level Pandas API</a></p></li>
<li><p><a class="reference internal" href="#graphical-models-and-potential-outcomes-best-of-both-worlds" id="id14">Graphical Models and Potential Outcomes: Best of both worlds</a></p></li>
<li><p><a class="reference internal" href="#id4" id="id15">因果推理的统一语言</a></p></li>
<li><p><a class="reference internal" href="#id5" id="id16">因果推断的四个步骤</a></p></li>
<li><p><a class="reference internal" href="#citing-this-package" id="id17">Citing this package</a></p></li>
<li><p><a class="reference internal" href="#roadmap" id="id18">Roadmap</a></p></li>
<li><p><a class="reference internal" href="#contributing" id="id19">Contributing</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="id1">
<h2><a class="toc-backref" href="#id9">编译申明</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>这是 DoWhy 官方教程的编译版本 by <a class="reference external" href="https://sites.google.com/view/causal-inference-zerotoall/home">Heyang Gong</a>。相对官方版本，该教程</p>
<ul class="simple">
<li><p>在保证意思准确的情况下，尽量翻译英文，调整好文章的组织和目录结构，</p></li>
<li><p>部分地方加入了一些中文个人理解和解读。</p></li>
</ul>
</div>
<div class="section" id="the-need-for-causal-inference">
<h2><a class="toc-backref" href="#id10">The need for causal inference</a><a class="headerlink" href="#the-need-for-causal-inference" title="Permalink to this headline">¶</a></h2>
<p>预测模型揭示了将观察数据中的 patterns that connect the inputs and outcome。To intervene, however, we need to estimate the effect of changing an input from its current value, for which no data exists. 这些问题涉及估计“反事实”，在决策场景中很常见。</p>
<ul class="simple">
<li><dl class="simple">
<dt>Will it work?</dt><dd><ul>
<li><p>Does a proposed change to a system improve people’s outcomes?</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Why did it work?</dt><dd><ul>
<li><p>What led to a change in a system’s outcome?</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>What should we do?</dt><dd><ul>
<li><p>What changes to a system are likely to improve outcomes for people?</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>What are the overall effects?</dt><dd><ul>
<li><p>How does the system interact with human behavior?</p></li>
<li><p>What is the effect of a system’s recommendations on people’s activity?</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>回答这些问题需要因果推理。虽然存在许多方法 for causal inference，it is hard to compare their assumptions and robustness of results. DoWhy 做了三点贡献，</p>
<ol class="arabic simple">
<li><p>(所有模型假设都显示给出) Provides a principled way of modeling a given problem as a causal graph so
that all assumptions are explicit.</p></li>
<li><p>(实现了一个因果推断统一框架) Provides a unified interface for many popular causal inference methods, combining the two major frameworks of graphical models and potential outcomes.</p></li>
<li><p>(可以进行稳健型分析) Automatically tests for the validity of assumptions if possible and assesses
the robustness of the estimate to violations.</p></li>
</ol>
</div>
<div class="section" id="installation">
<h2><a class="toc-backref" href="#id11">Installation</a><a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p><strong>Requirements</strong></p>
<p>DoWhy support Python 3+. It requires the following packages:</p>
<ul class="simple">
<li><p>numpy</p></li>
<li><p>scipy</p></li>
<li><p>scikit-learn</p></li>
<li><p>pandas</p></li>
<li><p>networkx  (for analyzing causal graphs)</p></li>
<li><p>matplotlib (for general plotting)</p></li>
<li><p>sympy (for rendering symbolic expressions)</p></li>
</ul>
<p>Install the latest release using pip.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pip install dowhy
</pre></div>
</div>
<p>If you prefer the latest dev version, clone this repository and run the following command from the top-most folder of
the repository.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pip install -e .
</pre></div>
</div>
<p>If you face any problems, try installing dependencies manually.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pip install -r requirements.txt
</pre></div>
</div>
<p>Optionally, if you wish to input graphs in the dot format, then install pydot (or pygraphviz).</p>
<p>For better-looking graphs, you can optionally install pygraphviz. To proceed,
first install graphviz and then pygraphviz (on Ubuntu and Ubuntu WSL).</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo apt install graphviz libgraphviz-dev graphviz-dev pkg-config
<span class="c1">## from https://github.com/pygraphviz/pygraphviz/issues/71</span>
pip install pygraphviz --install-option<span class="o">=</span><span class="s2">&quot;--include-path=/usr/include/graphviz&quot;</span> <span class="se">\</span>
--install-option<span class="o">=</span><span class="s2">&quot;--library-path=/usr/lib/graphviz/&quot;</span>
</pre></div>
</div>
<p>Keep in mind that pygraphviz installation can be problematic on the latest versions of Python3. Tested to work with Python 3.5.</p>
</div>
<div class="section" id="id3">
<h2><a class="toc-backref" href="#id12">使用 DoWhy 进行因果推断的一个简单例子</a><a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>Most DoWhy
analyses for causal inference take 4 lines to write, assuming a
pandas dataframe df that contains the data:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dowhy</span> <span class="kn">import</span> <span class="n">CausalModel</span>
<span class="kn">import</span> <span class="nn">dowhy.datasets</span>

<span class="c1"># Load some sample data</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">dowhy</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">linear_dataset</span><span class="p">(</span>
    <span class="n">beta</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">num_common_causes</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">num_instruments</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">num_samples</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
    <span class="n">treatment_is_binary</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>DoWhy supports two formats for providing the causal graph: <a class="reference external" href="https://github.com/GunterMueller/UNI_PASSAU_FMI_Graph_Drawing">gml</a> (preferred) and <a class="reference external" href="http://www.graphviz.org/documentation/">dot</a>. After loading in the data, we use the four main operations in DoWhy: <em>model</em>,
<em>estimate</em>, <em>identify</em> and <em>refute</em>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a causal model from the data and given graph.</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">CausalModel</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;df&quot;</span><span class="p">],</span>
    <span class="n">treatment</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;treatment_name&quot;</span><span class="p">],</span>
    <span class="n">outcome</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;outcome_name&quot;</span><span class="p">],</span>
    <span class="n">graph</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;gml_graph&quot;</span><span class="p">])</span>

<span class="c1"># Identify causal effect and return target estimands</span>
<span class="n">identified_estimand</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">identify_effect</span><span class="p">()</span>

<span class="c1"># Estimate the target estimand using a statistical method.</span>
<span class="n">estimate</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">estimate_effect</span><span class="p">(</span><span class="n">identified_estimand</span><span class="p">,</span>
                                 <span class="n">method_name</span><span class="o">=</span><span class="s2">&quot;backdoor.propensity_score_matching&quot;</span><span class="p">)</span>

<span class="c1"># Refute the obtained estimate using multiple robustness checks.</span>
<span class="n">refute_results</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">refute_estimate</span><span class="p">(</span><span class="n">identified_estimand</span><span class="p">,</span> <span class="n">estimate</span><span class="p">,</span>
                                       <span class="n">method_name</span><span class="o">=</span><span class="s2">&quot;random_common_cause&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>DoWhy stresses on the interpretability of its output. At any point in the analysis,
you can inspect the untested assumptions, identified estimands (if any) and the
estimate (if any). Here’s a sample output of the linear regression estimator.</p>
<img alt="https://raw.githubusercontent.com/microsoft/dowhy/master/docs/images/regression_output.png" src="https://raw.githubusercontent.com/microsoft/dowhy/master/docs/images/regression_output.png" />
<p>For detailed code examples, check out the Jupyter notebooks in <a class="reference external" href="https://github.com/microsoft/dowhy/tree/master/docs/source/example_notebooks/">docs/source/example_notebooks</a>, or try them online at <a class="reference external" href="https://mybinder.org/v2/gh/microsoft/dowhy/master?filepath=docs%2Fsource%2F">Binder</a>.</p>
</div>
<div class="section" id="a-high-level-pandas-api">
<h2><a class="toc-backref" href="#id13">A High-level Pandas API</a><a class="headerlink" href="#a-high-level-pandas-api" title="Permalink to this headline">¶</a></h2>
<p>我们使用该 API 和内置数据集合生成函数，生成用于研究的模拟干预数据。
We’ve made an even simpler API for dowhy which is a light layer on top of the standard one. The goal
was to make causal analysis much more like regular exploratory analysis. To use this API, simply
import <code class="code docutils literal notranslate"><span class="pre">dowhy.api</span></code>. This will magically add the <code class="code docutils literal notranslate"><span class="pre">causal</span></code> namespace to your
<code class="code docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> s. Then, you can use the namespace as follows.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">dowhy.api</span>
<span class="kn">import</span> <span class="nn">dowhy.datasets</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">dowhy</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">linear_dataset</span><span class="p">(</span><span class="n">beta</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">num_common_causes</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">num_instruments</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">num_samples</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
    <span class="n">treatment_is_binary</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c1"># data[&#39;df&#39;] is just a regular pandas.DataFrame</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;df&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">causal</span><span class="o">.</span><span class="n">do</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;v0&#39;</span><span class="p">,</span> <span class="c1"># name of treatment variable</span>
                     <span class="n">variable_types</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;v0&#39;</span><span class="p">:</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;W0&#39;</span><span class="p">:</span> <span class="s1">&#39;c&#39;</span><span class="p">},</span>
                     <span class="n">outcome</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span>
                     <span class="n">common_causes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;W0&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;v0&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="https://raw.githubusercontent.com/microsoft/dowhy/master/docs/images/do_barplot.png" src="https://raw.githubusercontent.com/microsoft/dowhy/master/docs/images/do_barplot.png" />
<p>For some methods, the <code class="code docutils literal notranslate"><span class="pre">variable_types</span></code> field must be specified. It should be a <code class="code docutils literal notranslate"><span class="pre">dict</span></code>, where the keys are
variable names, and values are ‘o’ for ordered discrete, ‘u’ for un-ordered discrete, ‘d’ for discrete, or ‘c’
for continuous.</p>
<p><strong>Note:If the</strong> <code class="code docutils literal notranslate"><span class="pre">variable_types</span></code> <strong>is not specified we make use of the following implicit conversions:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="o">-&gt;</span> <span class="s1">&#39;c&#39;</span>
<span class="nb">float</span> <span class="o">-&gt;</span> <span class="s1">&#39;c&#39;</span>
<span class="n">binary</span> <span class="o">-&gt;</span> <span class="s1">&#39;b&#39;</span>
<span class="n">category</span> <span class="o">-&gt;</span> <span class="s1">&#39;d&#39;</span>
</pre></div>
</div>
<p><strong>Currently we have not added support for time.</strong></p>
<p>The <code class="code docutils literal notranslate"><span class="pre">do</span></code> method in the causal namespace generates a random sample from $P(outcome|do(X=x))$ of the
same length as your data set(这个有一个关键问题，只有因果图而因果机制没有给定时候，是没有办法进行抽样的，也就是我们需要知晓数据的生成模型！也就是说这里只是生成干预数据集合的一种方式！), and returns this outcome as a new <code class="code docutils literal notranslate"><span class="pre">DataFrame</span></code>. You can continue to perform the usual <code class="code docutils literal notranslate"><span class="pre">DataFrame</span></code> operations with this sample, and so you can compute statistics and create plots for causal outcomes!</p>
<p>The <code class="code docutils literal notranslate"><span class="pre">do</span></code> method is built on top of the lower-level <code class="code docutils literal notranslate"><span class="pre">dowhy</span></code> objects, so can still take a graph and perform
identification automatically when you provide a graph instead of <code class="code docutils literal notranslate"><span class="pre">common_causes</span></code>.</p>
</div>
<div class="section" id="graphical-models-and-potential-outcomes-best-of-both-worlds">
<h2><a class="toc-backref" href="#id14">Graphical Models and Potential Outcomes: Best of both worlds</a><a class="headerlink" href="#graphical-models-and-potential-outcomes-best-of-both-worlds" title="Permalink to this headline">¶</a></h2>
<p>DoWhy builds on two of the most powerful frameworks for causal inference:
graphical models and potential outcomes. It uses graph-based criteria and
do-calculus for modeling assumptions and identifying a non-parametric causal effect.
For estimation, it switches to methods based primarily on potential outcomes.</p>
</div>
<div class="section" id="id4">
<h2><a class="toc-backref" href="#id15">因果推理的统一语言</a><a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<p>DoWhy基于简单的统一语言进行因果推断。因果推断似乎有些棘手，但几乎所有方法都遵循四个关键步骤：</p>
<ol class="arabic simple">
<li><p>Model a causal inference problem using assumptions.</p></li>
<li><p>Identify an expression for the causal effect under these assumptions (“causal estimand”).</p></li>
<li><p>Estimate the expression using statistical methods such as matching or instrumental variables.</p></li>
<li><p>Finally, verify the validity of the estimate using a variety of robustness checks.</p></li>
</ol>
<p>该工作流可以通过DoWhy中的四个关键动词来捕获：</p>
<ul class="simple">
<li><p>model</p></li>
<li><p>identify</p></li>
<li><p>estimate</p></li>
<li><p>refute</p></li>
</ul>
<p>Using these verbs, DoWhy implements a causal inference engine that can support
a variety of methods. <em>model</em> encodes prior knowledge as a formal causal graph, <em>identify</em> uses
graph-based methods to identify the causal effect, <em>estimate</em> uses
statistical methods for estimating the identified estimand, and finally <em>refute</em>
tries to refute the obtained estimate by testing robustness to assumptions.</p>
<p>与其他因果推理的可用软件相比，DoWhy有三个关键不同之处：</p>
<dl>
<dt><strong>Explicit identifying assumptions</strong></dt><dd><p>因果假设是DoWhy中的一等公民。</p>
<p>Each analysis starts with a
building a causal model. The assumptions can be viewed graphically or in terms
of conditional independence statements. Wherever possible, DoWhy can also
automatically test for stated assumptions using observed data.</p>
</dd>
<dt><strong>Separation between identification and estimation</strong></dt><dd><p>Identification 是因果问题, 而 Estimation 统计问题.</p>
<p>DoWhy
respects this boundary and treats them separately. This focuses the causal
inference effort on identification, and frees up estimation using any
available statistical estimator for a target estimand. In addition, multiple
estimation methods can be used for a single identified_estimand and
vice-versa.</p>
</dd>
<dt><strong>Automated robustness checks</strong></dt><dd><p>What happens when key identifying assumptions may not be satisfied?</p>
<p>因果分析中最关键且经常被跳过的部分 is checking the
robustness of an estimate to unverified assumptions, 也就是敏感性分析. DoWhy makes it easy to
automatically run sensitivity and robustness checks on the obtained estimate.</p>
</dd>
</dl>
<p>最后，DoWhy易于扩展, allowing other implementations of the
four verbs to co-exist (we hope to integrate with external
implementations in the future). The four verbs are mutually independent, so their
implementations can be combined in any way.</p>
<p>下面是有关每个动词的当前实现的更多详细信息。</p>
</div>
<div class="section" id="id5">
<h2><a class="toc-backref" href="#id16">因果推断的四个步骤</a><a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h2>
<ol class="upperroman simple">
<li><p><strong>Model a causal problem</strong></p></li>
</ol>
<p>DoWhy为每个问题创建潜在的因果图模型。这个用于使每个因果假设明确。此图不必是完整—您可以提供部分图形，表示先验有关某些变量的知识。DoWhy自动考虑其余部分变量作为潜在的混杂因素。</p>
<p>Currently, DoWhy supports two formats for graph input: <a class="reference external" href="https://github.com/GunterMueller/UNI_PASSAU_FMI_Graph_Drawing">gml</a> (preferred) and
<a class="reference external" href="http://www.graphviz.org/documentation/">dot</a>. We strongly suggest to use gml as the input format, as it works well with networkx. You can provide the graph either as a .gml file or as a string. If you prefer to use dot format, you will need to install additional packages (pydot or pygraphviz, see the installation section above). Both .dot files and string format are supported.</p>
<p>虽然不建议使用，但您也可以 specify common causes and/or instruments directly
而不必指定因果图.</p>
<ol class="upperroman simple" start="2">
<li><p><strong>Identify a target estimand under the model</strong></p></li>
</ol>
<p>Based on the causal graph, DoWhy finds all possible ways of identifying a desired causal effect based on
the graphical model. It uses graph-based criteria and do-calculus to find
potential ways find expressions that can identify the causal effect.</p>
<ol class="upperroman simple" start="3">
<li><p><strong>Estimate causal effect based on the identified estimand</strong></p></li>
</ol>
<p>DoWhy supports methods based on both back-door criterion and instrumental
variables. It also provides a non-parametric permutation test for testing
the statistical significance of obtained estimate.</p>
<p>Currently supported back-door criterion methods.</p>
<ul class="simple">
<li><dl class="simple">
<dt>Methods based on estimating the treatment assignment</dt><dd><ul>
<li><p>Propensity-based Stratification</p></li>
<li><p>Propensity Score Matching</p></li>
<li><p>Inverse Propensity Weighting</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Methods based on estimating the response surface</dt><dd><ul>
<li><p>Regression</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>Currently supported methods based on instrumental variables.</p>
<ul class="simple">
<li><p>Binary Instrument/Wald Estimator</p></li>
<li><p>Regression discontinuity</p></li>
</ul>
<ol class="upperroman simple" start="4">
<li><p><strong>Refute the obtained estimate</strong></p></li>
</ol>
<p>可以使用多种 refutation methods to verify a causal inference 是使用DoWhy的主要好处。DoWhy supports the following refutation methods.</p>
<ul class="simple">
<li><p>Placebo Treatment</p></li>
<li><p>Irrelevant Additional Confounder</p></li>
<li><p>Subset validation</p></li>
</ul>
</div>
<div class="section" id="citing-this-package">
<h2><a class="toc-backref" href="#id17">Citing this package</a><a class="headerlink" href="#citing-this-package" title="Permalink to this headline">¶</a></h2>
<p>If you find DoWhy useful for your research work, please cite us as follows:</p>
<p>Amit Sharma, Emre Kiciman, et al. DoWhy: A Python package for causal inference. 2019. <a class="reference external" href="https://github.com/microsoft/dowhy">https://github.com/microsoft/dowhy</a></p>
<p>Bibtex:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@misc</span><span class="p">{</span><span class="n">dowhy</span><span class="p">,</span>
<span class="n">authors</span><span class="o">=</span><span class="p">{</span><span class="n">Sharma</span><span class="p">,</span> <span class="n">Amit</span> <span class="ow">and</span> <span class="n">Kiciman</span><span class="p">,</span> <span class="n">Emre</span> <span class="ow">and</span> <span class="n">others</span><span class="p">},</span>
<span class="n">title</span><span class="o">=</span><span class="p">{</span><span class="n">Do</span><span class="p">{</span><span class="n">W</span><span class="p">}</span><span class="n">hy</span><span class="p">:</span> <span class="p">{</span><span class="n">A</span> <span class="n">Python</span> <span class="n">package</span> <span class="k">for</span> <span class="n">causal</span> <span class="n">inference</span><span class="p">}},</span>
<span class="n">howpublished</span><span class="o">=</span><span class="p">{</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">microsoft</span><span class="o">/</span><span class="n">dowhy</span><span class="p">}</span>
<span class="n">year</span><span class="o">=</span><span class="p">{</span><span class="mi">2019</span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="roadmap">
<h2><a class="toc-backref" href="#id18">Roadmap</a><a class="headerlink" href="#roadmap" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference external" href="https://github.com/microsoft/dowhy/projects">projects</a> page lists the next steps for DoWhy. If you would like to contribute, have a look at the current projects. If you have a specific request for DoWhy, please raise an issue <a class="reference external" href="https://github.com/microsoft/dowhy/issues">here</a>.</p>
</div>
<div class="section" id="contributing">
<h2><a class="toc-backref" href="#id19">Contributing</a><a class="headerlink" href="#contributing" title="Permalink to this headline">¶</a></h2>
<p>This project welcomes contributions and suggestions.  Most contributions require you to agree to a
Contributor License Agreement (CLA) declaring that you have the right to, and actually do, grant us
the rights to use your contribution. For details, visit <a class="reference external" href="https://cla.microsoft.com">https://cla.microsoft.com</a>.</p>
<p>When you submit a pull request, a CLA-bot will automatically determine whether you need to provide
a CLA and decorate the PR appropriately (e.g., label, comment). Simply follow the instructions
provided by the bot. You will only need to do this once across all repos using our CLA.</p>
<p>This project has adopted the <a class="reference external" href="https://opensource.microsoft.com/codeofconduct/">Microsoft Open Source Code of Conduct</a>.
For more information see the <a class="reference external" href="https://opensource.microsoft.com/codeofconduct/faq/">Code of Conduct FAQ</a> or
contact <a class="reference external" href="mailto:opencode&#37;&#52;&#48;microsoft&#46;com">opencode<span>&#64;</span>microsoft<span>&#46;</span>com</a> with any additional questions or comments.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="example_notebooks/nb_index.html" class="btn btn-neutral float-right" title="&lt;no title&gt;" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="DoWhy | 让因果推断容易" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Microsoft

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>